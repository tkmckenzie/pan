setwd("~/git/pan/open_data/abq")
source("~/git/pan/open_data/abq/travel.R", echo=TRUE)
head(df)
unique(df$Department...Division)
sort(unique(df$Department...Division))
df.dept = df %>%
group_by(Department...Division) %>%
summarize(Percent.Total.Difference = mean(Percent.Total.Difference))
source("~/git/pan/open_data/abq/travel.R", echo=TRUE)
df.dept
View(df.dept)
df.dept = df %>%
group_by(Department...Division) %>%
summarize(Percent.Total.Difference = mean(Percent.Total.Difference),
count = n())
View(df.dept)
df.dept = df %>%
group_by(Department...Division) %>%
summarize(Actual.Total = mean(Actual.Total),
Percent.Total.Difference = mean(Percent.Total.Difference),
count = n())
View(df.dept)
source("~/git/pan/open_data/abq/travel.R", echo=TRUE)
View(df.dept)
ggplot(df.dept, aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(size = count)) +
theme_bw()
ggplot(df.dept, aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(size = count, color = Department..Division)) +
theme_bw()
head(df.dept)
ggplot(df.dept, aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(size = count, color = Department...Division)) +
theme_bw()
ggplot(df.dept, aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(size = count, color = Department...Division)) +
theme_bw() +
theme(legend.position = "top")
df.dept = df %>%
group_by(Department...Division) %>%
summarize(Actual.Total = mean(Actual.Total),
Percent.Total.Difference = mean(Percent.Total.Difference),
count = n()) %>%
filter(Department...Division != "")
ggplot(df.dept, aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(size = count, color = Department...Division)) +
theme_bw() +
theme(legend.position = "top")
ggplot(df, aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(size = count, color = Department...Division)) +
theme_bw() +
theme(legend.position = "top")
ggplot(df, aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(color = Department...Division)) +
theme_bw() +
theme(legend.position = "top")
ggplot(df %>% filter(Department...Division != ""), aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(color = Department...Division)) +
theme_bw() +
theme(legend.position = "top")
ggplot(df %>% filter(Department...Division != ""), aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(color = Department...Division)) +
xlim(0, 5000) +
theme_bw() +
theme(legend.position = "top")
ggplot(df %>% filter(Department...Division != ""), aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(color = Department...Division)) +
xlim(0, 5000) +
ylim(NA, 200)
ggplot(df %>% filter(Department...Division != ""), aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(color = Department...Division)) +
xlim(0, 5000) +
ylim(NA, 200) +
theme_bw() +
theme(legend.position = "top")
df.person = df %>%
group_by(Traveler.Name) %>%
summarize(Actual.Total = mean(Actual.Total),
Percent.Total.Difference = mean(Percent.Total.Difference),
count = n())
df.person = df %>%
group_by(Traveler.Name) %>%
summarize(Actual.Total = mean(Actual.Total),
Total.Difference = mean(Total.Difference),
Percent.Total.Difference = mean(Percent.Total.Difference),
count = n())
df.person %>% arrange(Total.Difference)
df.person %>% arrange(-Total.Difference)
df.person %>% arrange(-Percent.Total.Difference)
df.person %>% arrange(-Percent.Total.Difference) %>% filter(count > 1)
df.person %>% arrange(-Total.Difference) %>% filter(count > 1)
df.person = df %>%
group_by(Traveler.Name) %>%
summarize(Actual.Total = mean(Actual.Total),
Avg.Total.Difference = mean(Total.Difference),
Total.Difference = sum(Total.Difference),
Percent.Total.Difference = mean(Percent.Total.Difference),
count = n())
df.person %>% arrange(-Total.Difference) %>% filter(count > 1)
df.person %>% arrange(-Avg.Total.Difference) %>% filter(count > 1)
head(df)
ggplot(df %>% filter(Department...Division != ""), aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(color = Department...Division)) +
geom_abline(slope = 0.1, intercept = 0) +
xlim(0, 5000) +
ylim(NA, 200) +
theme_bw() +
theme(legend.position = "top")
ggplot(df %>% filter(Department...Division != ""), aes(Actual.Total, Percent.Total.Difference)) +
geom_point(aes(color = Department...Division)) +
geom_abline(slope = 0.1, intercept = -100) +
xlim(0, 5000) +
ylim(NA, 200) +
theme_bw() +
theme(legend.position = "top")
df.dept = df.dept %>%
mutate(Percent.Total.Difference.max = -100 + 0.1 * Actual.Total)
df.dept %>% filter(Percent.Total.Difference > Percent.Total.Difference.max)
df.dept %>% filter(Percent.Total.Difference >= Percent.Total.Difference.max)
head(df)
unique(df$Business.Purpose)
